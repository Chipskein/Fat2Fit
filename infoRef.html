<!DOCTYPE html>
<html>
    <head>
        <!--Import Google Icon Font-->
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <!--Import materialize.css-->
        <link type="text/css" rel="stylesheet" href="css/materialize.min.css"  media="screen,projection"/>
        <link rel="icon" href="imgs/diet.png" type="image/png">
        <link rel="stylesheet" href="css/style.css">
        <link rel="manifest" href="manifest.json">
        <!--Let browser know website is optimized for mobile-->
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
        <title>Fat2fit</title>
    </head>
    <body>
            <div class="container">
                <div class="header row">
                    <img src="imgs/diet.png" class="logo" alt="">
                    <p class="logoTxt">Fat to Fit</p>
                </div>
                <p id="refeicao-name"></p>
                <p id='alimentos-txt'>Alimentos</p>
                <div id="alimentos-refe"></div>
                <button onclick="previusPage()">Previus Page</button><button onclick="nextPage()">Next Page</button>
                <div class="alimentos-footer2">
                    <p id="total">Total 0 KCAL</p>
                    <div id="back-button"  onclick="{location.href='index.html'}">
                        <p>Voltar</p>
                    </div>
                </div>
                <br>
            </div>
        <script>
            let offset=1;//
            let limit=5;
            window.addEventListener('DOMContentLoaded', (event) => {
                if(localStorage.getItem('refeicao')){
                    let txt=document.getElementById('refeicao-name');
                    txt.innerHTML = `${localStorage.getItem('refeicao')}`;
                    if(localStorage.getItem('refeicao')=='Café da Manhã'){
                        txt.style.color="var(--ciano-color)";
                    }
                    if(localStorage.getItem('refeicao')=='Almoco'){
                        txt.style.color="var(--azul-color)";
                    }
                    if(localStorage.getItem('refeicao')=='Café da Tarde'){
                        txt.style.color="var(--amarelo-color)";
                    }
                    if(localStorage.getItem('refeicao')=='Janta'){
                        txt.style.color="var(--laranja-color)";
                    }
                    getAliments();
                }
            });
            if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./sw.js')
            .then(function () {console.log('service worker registered');})
            .catch(function () {console.log('service worker failed'); });
            }

            function getAliments(){
                let refeicoes=localStorage.getItem('refeicoes');
                refeicoes=JSON.parse(refeicoes);
                let div=document.getElementById('alimentos-refe');
                let txt = '';
                if(document.getElementById("refeicao-name").innerHTML=='Café da Manhã'){
                    let c1=0;
                    for(let c=offset-1;c1<limit&&c<refeicoes.cafe.length;c++){
                        txt += `
                        <div class="alimento-container" id="">
                            <div class=alimento-ico-tx>
                            <img class="alimento-icon" src="./imgs/dish.png" />
                            <p class="alimento-txt">${refeicoes.cafe[c].description}</p>
                            </div>
                            <p class="alimento-kcal">${Math.round(refeicoes.cafe[c].attributes.energy.kcal)} kcal</p>
                            <div class="alimento-btn" onclick="" ><img class="alimento-btn-icon" src="./imgs/minus.png" alt="" srcset=""></div>
                        </div>`;
                        c1++
                    }
                    div.innerHTML = txt;
                }
                if(document.getElementById("refeicao-name").innerHTML=='Almoco'){
                }
                if(document.getElementById("refeicao-name").innerHTML=='Café da Tarde'){
                }
                if(document.getElementById("refeicao-name").innerHTML=='Janta'){
                }
            }
            function nextPage(){
                let refeicoes=localStorage.getItem('refeicoes');
                refeicoes=JSON.parse(refeicoes);
                total=0;
                if(document.getElementById("refeicao-name").innerHTML=='Café da Manhã'){
                    total=refeicoes.cafe.length;
                }
                if(document.getElementById("refeicao-name").innerHTML=='Almoco'){
                    total=refeicoes.almoco.length;
                }
                if(document.getElementById("refeicao-name").innerHTML=='Café da Tarde'){
                    total=refeicoes.cafeTarde.length;
                }
                if(document.getElementById("refeicao-name").innerHTML=='Janta'){
                    total=refeicoes.janta.length;
                }
                offset+=4;
                offset > total ? offset=total:false
                getAliments();
            };
            function previusPage(){
                offset-=4
                offset < 0 ? offset=1:false;
                getAliments();
            };
        </script>
        <script type="text/javascript" src="js/materialize.min.js"></script>
    </body>
</html>